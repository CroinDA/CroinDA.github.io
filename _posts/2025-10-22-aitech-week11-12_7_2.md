---
layout: single
title: "[RecSys / 딥러닝을 활용한 추천시스템] RNN을 활용한 추천시스템 모델 (GRU4Rec)"
categories:
  - recsys_basic
tags:
  - 부스트캠프
  - AITech
  - RecSys
  - RNN
  - GRU4Rec
author_profile: false
use_math: true
---

# Review: RNN 계열 모델 리뷰

링크

링크

<br>

# GRU4Rec: 개요 및 핵심 아이디어

- “지금” 고객이 원하는 상품 추천을 목표
- RNN을 추천시스템에 적용
- 논문 바로가기: [Session-Based Recommendations with Recurrent Neural Network](https://arxiv.org/pdf/1511.06939)
- 핵심 아이디어 → **Session 시퀀스**를 GRU 레이어에 입력해서, <mark style="background-color: #fdecc8">바로 다음에 올 확률이 가장 높은 아이템</mark>을 추천
<br>

# GRU4Rec: 논문리뷰

## 개요

- 순환 신경망(RNN)을** 세션 기반 추천 시스템에 최초로 적용**한 선구적 연구
- 2016년 ICLR 발표, 4000회 이상 인용된 추천시스템 분야에서 영향력이 높은 논문
<br>

## 연구 배경 및 동기

### 세션 기반 추천의 필요성

- 세션(Session)이란?
- 해결하고자 하는 문제
- **기존 방법론의 한계**
<br>

### 핵심 기여사항

- 기존 추천 시스템 방법론(MF, 이웃기반, Markov 등)이 세션 맥락과 익명 사용자 데이터에 취약하다는 한계를 지적 → 이를 극복하기 위해 세션 기반 추천문제에 적합한, RNN 기반 접근법을 제시
- Session이라는 **단기적·순차적 사용자의 행동 시퀀스를 효과적으로 모델링**할 수 있는 RNN(GRU) 아키텍처 도입
- 세부 사항
<br>

## 모델 구조 상세

### GRU4Rec의 기본 구조: GRU

- LSTM의 변형 중 하나, output gate가 따로 없음
- Cell state와 Hidden state를 하나의 벡터로 통합
- Vanishing Gradient 문제 해결을 위해 고안된 구조
- GRU 구성 Gate
<br>

### GRU를 채택하는 이유

- LSTM보다 파라미터가 적어 학습이 빠름
- 성능도 LSTM과 Vanila RNN보다 성능이 우수함(실험결과)
<br>

### 모델의 입출력 구조

![](/images/2025-10-22-aitech-week11-12_7_2/image1.png)

1. 입력 단계: 세션 데이터의 시퀀스 표현
1. Embedding Layer
1. GRU Layers
1. Feedforward(Fully-connected) layers
1. Output Layer
<br>

### 모델의 핵심 혁신사항 3가지

1. Session-parallel Mini-batches
1. Output Sampling
1. Ranking-based Loss
1. 1~3번 종합 구조 요약
<br>

### Experiments

**데이터셋**

**RSC15 (RecSys Challenge 2015)**

- 이커머스 클릭스트림 데이터
- 학습: 6개월, 7,966,257 세션, 31,637,239 클릭, 37,483 아이템
- 테스트: 1일, 15,324 세션, 71,222 이벤트
**VIDEO (YouTube-like OTT platform)**

- 비디오 시청 데이터 (일정 시간 이상 시청)
- 학습: ~3백만 세션, ~13백만 이벤트, 330천 비디오
- 테스트: 마지막 날, ~37천 세션, ~180천 이벤트
<br>

**평가 지표**

**Recall@20**

- 상위 20개 추천 중, 정답 아이템이 포함된 비율
(실제 추천 시스템은 소수의 아이템만 추천 가능)
- Click-Through Rate(CTR)와 높은 상관관계
**MRR@20 (Mean Reciprocal Rank)**

- 정답 아이템의 순위를 고려
- 순위가 중요한 경우 사용하는 지표(스크롤 필요 등)
- 20위 이하면 0으로 처리
<br>

**실험 결과**

Baseline(POP, S-POP, Item-KNN, BPR-MF)의 실험 결과

- 간략한 모델 소개
- 실험 결과
<br>

GRU4Rec의 성능(table 3 → BPR, TOP1)

![Cross-Entropy는 N값이 증가할 수록 Gradient Vanishing/exploding이 빈번하게 발생 → 수렴 실패로 결과 누락](/images/2025-10-22-aitech-week11-12_7_2/image2.png)

- 실험 결과
<br>

하이퍼 파라미터 설정

- 데이터셋 및 loss function에 따라 다름(table2)
### GRU4Rec의 영향력 및 후속 연구

세션 기반 추천 연구의 기초 / GRU를 추천시스템에 적용한 최초 논문

1. **GRU4REC v2 (2018)**:
1. **SR-GNN → Graph Neural Network (GNN) 기반**
1. **Attention Mechanism 적용**
1. **Transformer 기반 모델**